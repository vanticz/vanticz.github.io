
 <!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
    <title>Manacher&#39;s Algorithm | Learn Record Share</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Zeming Zhou">
    

    
    <meta name="description" content="In computer science, the longest palindromic substring or longest symmetric factor problem is the problem of finding a maximum-length contiguous substring of a given string that is also a palindrome.">
<meta property="og:type" content="article">
<meta property="og:title" content="Manacher's Algorithm">
<meta property="og:url" content="http://vanticz.github.io/post/Manachers-Algorithm/index.html">
<meta property="og:site_name" content="Learn Record Share">
<meta property="og:description" content="In computer science, the longest palindromic substring or longest symmetric factor problem is the problem of finding a maximum-length contiguous substring of a given string that is also a palindrome.">
<meta property="og:updated_time" content="2016-11-29T19:43:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Manacher's Algorithm">
<meta name="twitter:description" content="In computer science, the longest palindromic substring or longest symmetric factor problem is the problem of finding a maximum-length contiguous substring of a given string that is also a palindrome.">

    
    <link rel="alternative" href="/atom.xml" title="Learn Record Share" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.jpg">
    
    
    <link rel="apple-touch-icon" href="/img/black_man.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/black_man.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.jpg" alt="Learn Record Share" title="Learn Record Share"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Learn Record Share">Learn Record Share</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:vanticz.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/post/Manachers-Algorithm/" title="Manacher&#39;s Algorithm" itemprop="url">Manacher&#39;s Algorithm</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Zeming Zhou" target="_blank" itemprop="author">Zeming Zhou</a>
		
  <p class="article-time">
    <time datetime="2016-11-29T15:58:42.000Z" itemprop="datePublished"> Published 2016-11-29</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Source"><span class="toc-number">1.</span> <span class="toc-text">Source</span></a></li></ol>
		
		</div>
		
		<blockquote>
<p>In computer science, the longest palindromic substring or longest symmetric factor problem is the problem of finding a maximum-length contiguous substring of a given string that is also a palindrome.</p>
<p>A palindrome is a word, phrase, number, or other sequence of characters which reads the same backward or forward, such as ‘madam’ or ‘kayak’.</p>
</blockquote>
<p>Manacher’s algorithm can find the longest palindromic substring in time complexity <strong>O(n)</strong>.</p>
<p>Algorithms are different when detecting odd-length palindrome and even-length palindrome. So the first step of Manacher’s algorithm uses a trick to eliminate this difference: pick a special character that does not exist in the original string, insert it on both sides of each character.</p>
<p>For example:</p>
<p><code>aba</code> and <code>|</code> becomes <code>|a|b|a|</code></p>
<p><code>abba</code> and <code>#</code> becomes <code>#a#b#b#a#</code></p>
<p>Now the length of the new string is guaranteed to be odd, we call this new string <em>S</em> for simplicity.</p>
<p>Then it uses an helper array/list P to track the radius of the longest palindrome centered at each character. P[i] is the radius of the longest palindrome centered at S[i], and P[i] has a minimum value 1, when the longest palindrome is S[i] itself.</p>
<p>For example:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">S:	<span class="preprocessor"># a # b # a #</span></span><br><span class="line">P:	<span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">4</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">S:	<span class="preprocessor"># a # b # b # a #</span></span><br><span class="line">P:	<span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>We can prove that P[i]-1 is the length of palindrome centered at S[i] in the original string.</p>
<p><strong>Proof:</strong></p>
<p>A palindrome in the new string S must begin and end with #</p>
<pre><code><span class="tag">e</span><span class="class">.g</span>. #, <span class="id">#a</span>#, <span class="id">#a</span><span class="id">#b</span><span class="id">#b</span><span class="id">#a</span>#
</code></pre><p>If we get rid of a # either at the begining or the end of palindrome, each character has a # to pair with.</p>
<pre><code>e.g. <span class="comment">()</span>, <span class="comment">(a#)</span>, <span class="comment">(a#)</span><span class="comment">(b#)</span><span class="comment">(b#)</span><span class="comment">(a#)</span>
</code></pre><p>That means the length of palindrome in S minus one is twice the size of palindrome in the original string.</p>
<p>Let L = 2 * P[i] - 1 be the length of palindrome in S centered at S[i], then the length of palindrome in original string is (L - 1) / 2,<br>equals to P[i] - 1.</p>
<p>End of proof.</p>
<p>Because palindromics are symmetric, we can use dynamic programming to reuse some calculation. We add aother different special character at the begining to prevent potential index out of bound error, now useful indices starts from 1.</p>
<p>The code structure in pseudo-code:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">S = new string mentioned above</span><br><span class="line">P = []</span><br><span class="line">maxId = <span class="number">0</span></span><br><span class="line">id = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="tag">i</span> <span class="keyword">in</span> <span class="number">1</span> to sLen:</span><br><span class="line">	<span class="keyword">if</span> maxId &gt; <span class="tag">i</span>:</span><br><span class="line">		P[i] = <span class="function"><span class="title">min</span><span class="params">(p[<span class="number">2</span>*id-i], maxId-i)</span></span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		P[i] = <span class="number">1</span></span><br><span class="line">		</span><br><span class="line">	while S[i+P[i]] == S[i-P[i]]:</span><br><span class="line">		P[i]++</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> P[i]+<span class="tag">i</span> &gt; maxId:</span><br><span class="line">		maxId = P[i] + <span class="tag">i</span></span><br><span class="line">		id = i</span><br></pre></td></tr></table></figure>
<h4 id="Source">Source</h4><p>[1] Wikipedia: <a href="https://en.wikipedia.org/wiki/Longest_palindromic_substring" target="_blank" rel="external">Longest palindromic substring</a></p>
<p>[2] Wikipedia: <a href="https://en.wikipedia.org/wiki/Palindrome" target="_blank" rel="external">Palindrome</a></p>
<p>[3] GeeksforGeeks: <a href="http://www.geeksforgeeks.org/manachers-algorithm-linear-time-longest-palindromic-substring-part-1/" target="_blank" rel="external">Manacher’s Algorithm – Part 1</a> <a href="http://www.geeksforgeeks.org/manachers-algorithm-linear-time-longest-palindromic-substring-part-2/" target="_blank" rel="external">Part 2</a></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Algorithm/">Algorithm</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://vanticz.github.io/post/Manachers-Algorithm/" data-title="Manacher&#39;s Algorithm | Learn Record Share" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/post/CSS-Selectors-2/"  title="CSS-Selectors(2)">
 <strong>next:</strong><br/> 
 <span>CSS-Selectors(2)
</span>
</a>
</div>

</nav>

	

<section id="comments" class="comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Source"><span class="toc-number">1.</span> <span class="toc-text">Source</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/CSS/" title="CSS">CSS<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Algorithm/" title="Algorithm">Algorithm<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://github.com/vanticz" target="_blank" title="Github">Github</a>
            
          </li>
        
    </ul>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Zeming (Van) Zhou. <br/>
			</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/vanticz" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="Zeming Zhou">Zeming Zhou</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>




<script type="text/javascript">

var disqus_shortname = 'vanticz';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
